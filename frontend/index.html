<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoBlog</title>
    <style>
        :root {
            --primary-color: #635bff;
            --text-color: #1a1f36;
            --background-color: #f7fafc;
            --card-background: #ffffff;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        header {
            background-color: var(--card-background);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        nav a, .new-post-btn {
            color: var(--text-color);
            text-decoration: none;
            margin-left: 1.5rem;
            transition: color 0.3s ease;
            cursor: pointer;
        }
        nav a:hover, .new-post-btn:hover {
            color: var(--primary-color);
        }
        main {
            padding: 4rem 0;
        }
        .post {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .post:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        .post h2 {
            margin-top: 0;
            color: var(--primary-color);
        }
        .post-meta {
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        #crypto-prices {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-top: 2rem;
        }
        #crypto-prices h3 {
            margin-top: 0;
            color: var(--primary-color);
        }
        .price-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .price-item:last-child {
            border-bottom: none;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .new-post-form {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .new-post-form input,
        .new-post-form textarea {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
        }
        .new-post-form button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .new-post-form button:hover {
            background-color: #4a44c9;
        }
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                align-items: flex-start;
            }
            nav a, .new-post-btn {
                margin-left: 0;
                margin-top: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">CryptoBlog</div>
                <div>
                    <a href="#" onclick="showHome()">Home</a>
                    <a href="#" onclick="showAbout()">About</a>
                    <span class="new-post-btn" onclick="showNewPostForm()">âž• New Post</span>
                </div>
            </nav>
        </div>
    </header>

    <div class="container">
        <main id="main-content">
            <!-- Content will be dynamically inserted here -->
        </main>

        <section id="crypto-prices">
            <h3>Latest Crypto Prices</h3>
            <div id="price-list">
                <!-- Prices will be dynamically inserted here -->
            </div>
        </section>
    </div>

    <script type="module">
        import { backend } from '/declarations/backend';

        async function showHome() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = '<p>Loading posts...</p>';
            try {
                const posts = await backend.getPosts();
                mainContent.innerHTML = posts.map((post, index) => `
                    <article class="post fade-in" style="animation-delay: ${index * 0.2}s">
                        <h2>${post.title}</h2>
                        <div class="post-meta">Published on ${post.date}</div>
                        <p>${post.content}</p>
                    </article>
                `).join('');
            } catch (error) {
                mainContent.innerHTML = '<p>Error loading posts. Please try again later.</p>';
                console.error('Error fetching posts:', error);
            }
        }

        function showAbout() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="post fade-in">
                    <h2>About CryptoBlog</h2>
                    <p>Welcome to CryptoBlog, your premier source for the latest news, analysis, and insights in the world of cryptocurrency and blockchain technology. Our team of experts is dedicated to bringing you accurate and up-to-date information to help you navigate this exciting and rapidly evolving field.</p>
                    <p>At CryptoBlog, we believe in the transformative power of blockchain technology and its potential to reshape industries and empower individuals. Our mission is to demystify complex concepts, provide thoughtful analysis, and keep you informed about the latest trends and developments in the crypto space.</p>
                </div>
            `;
        }

        function showNewPostForm() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="new-post-form fade-in">
                    <h2>Create a New Post</h2>
                    <form onsubmit="createNewPost(event)">
                        <input type="text" id="post-title" placeholder="Enter post title" required>
                        <textarea id="post-content" placeholder="Enter post content" required></textarea>
                        <button type="submit">Create Post</button>
                    </form>
                </div>
            `;
        }

        async function createNewPost(event) {
            event.preventDefault();
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            const date = new Date().toISOString().split('T')[0];
            try {
                await backend.createPost(title, content, date);
                showHome();
            } catch (error) {
                console.error('Error creating post:', error);
                alert('Failed to create post. Please try again.');
            }
        }

        function updatePrices() {
            const prices = {
                "Bitcoin": "$" + (Math.random() * 10000 + 30000).toFixed(2),
                "Ethereum": "$" + (Math.random() * 1000 + 2000).toFixed(2),
                "Cardano": "$" + (Math.random() * 1 + 0.5).toFixed(2)
            };

            const priceList = document.getElementById('price-list');
            priceList.innerHTML = Object.entries(prices).map(([coin, price]) => `
                <div class="price-item">
                    <span>${coin}</span>
                    <span>${price}</span>
                </div>
            `).join('');
        }

        showHome();
        updatePrices();
        setInterval(updatePrices, 60000);

        window.showHome = showHome;
        window.showAbout = showAbout;
        window.showNewPostForm = showNewPostForm;
        window.createNewPost = createNewPost;
    </script>
</body>
</html>